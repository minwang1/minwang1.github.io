<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Posts | minwang1</title>
<meta name="keywords" content="" />
<meta name="description" content="Posts - minwang1">
<meta name="author" content="">
<link rel="canonical" href="http://minwang1.github.io/post/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.48a18943c2fc15c38a372b8dde1f5e5dc0bc64fa6cb90f5a817d2f8c76b7f3ae.css" integrity="sha256-SKGJQ8L8FcOKNyuN3h9eXcC8ZPpsuQ9agX0vjHa3864=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://minwang1.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://minwang1.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://minwang1.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://minwang1.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="http://minwang1.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="http://minwang1.github.io/post/index.xml">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Posts" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="http://minwang1.github.io/post/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Posts"/>
<meta name="twitter:description" content=""/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://minwang1.github.io/post/"
    }
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://minwang1.github.io/" accesskey="h" title="minwang1 (Alt + H)">minwang1</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="http://minwang1.github.io/post/" title="Blog">
                    <span class="active"><i class='fa fa-heart'></i>Blog</span>
                </a>
            </li>
            <li>
                <a href="http://minwang1.github.io/tags/" title="Tags">
                    <span><i class='fa fa-road'></i>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header">
  <h1>Posts</h1>
</header>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Android dark 模式原理
    </h2>
  </header>
  <section class="entry-content">
    <p>Android dark 模式原理  sRgb to lab revert l lab to sRGB  float invertedL = std::min(110 - lab.L, 100.0f);
if (invertedL &lt; lab.L) {// 反转后的明度低于原明度，则使用反转后的明度lab.L = invertedL;// 使用 rgb 格式返回return LabToSRGB(lab, SkColorGetA(color));} else {// 直接返回原颜色return color;} 其他应用启动本应用ActivityStack如何处理 例如当前启动配置为A，当前栈情况 A-B，应用home进入后台，通过负一屏启动应用A。 如果不做任何处理，启动后栈情况：A-B-A。而预期栈情况仍热为A-B，即用户上一次操作状况。
解决方法： 通过splashActivity做中转。 1.创建一个空的SplashActivity，theme为透明，配置为启动activity。 2.在splashActivity中做转发处理，如果当前activity栈中有其他activity，则退出splashActivity，top activity会resume，如果没有其他activity，则启动 mainactivity。
统计启动时间 adb shell am start -S -R 10 -W com.example.app/.MainActivity
-S表示每次启动前先强行停止 -R表示重复测试次数。
application attachBaseContext开始计算时间，activity onWindowFocusChanged大致为用户可见，可计算启动结束时间。...</p>
  </section>
  <footer class="entry-footer"><span title='2022-03-21 22:01:14 +0800 CST'>March 21, 2022</span></footer>
  <a class="entry-link" aria-label="post link to Android dark 模式原理" href="http://minwang1.github.io/post/android-drak-theme/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Android字体小结
    </h2>
  </header>
  <section class="entry-content">
    <p>字体小结： font family/typeface可以设置字体类别:  有衬：serif ：字符有装饰适合打印显示 无衬：sans-serif ：字符无饰适合显示屏显示 等宽：monospace：字符的宽度相等适合代码显示  fontStyle可设置字体粗细、倾斜    样式 字重     italic    light 300   Regular 400   medium 500   bold 700    android 默认fontFamily  英文字符 roboto 中文字符 思源雅黑  Android 英文默认使用roboto字体，robot字体不包含cjk（汉字）字符，如果显示汉字字符，会使用对应的思源雅黑字体。
思源雅黑Android中没有medium样式，所以如果代码中仅仅设置了sans-serif-medium，英文字符能正常显示，中文字符不能正常显示需要通过指定fontweight:500替代显示</p>
  </section>
  <footer class="entry-footer"><span title='2022-03-21 22:01:14 +0800 CST'>March 21, 2022</span></footer>
  <a class="entry-link" aria-label="post link to Android字体小结" href="http://minwang1.github.io/post/android-font/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Android常用性能分析
    </h2>
  </header>
  <section class="entry-content">
    <p>perfetto 工具 （替代systrace）  加载：perfetto 会生成.perfetto-trace文件 加载.perfetto-trace文件需要使用网站 https://ui.perfetto.dev/#!/ 网站抓取：打开网站，选择record new trace选项，经行配置后可抓取，需要Android 10以上设备，并且厂商设备支持 adb抓取：用网站抓取的步骤，正确的选择设备版本，不同版本使用的命令不同，点击startRecording后会出现recording command。 将recordingcommand粘贴到shell中执行。 手机上抓取：手机进入开发者模式，找到系统跟踪选项，点击清除已保存跟踪路径，会弹出对话框显示文件生成保存路径。打开显示快捷设置图块。 然后可以再下拉菜单中开启、关闭抓取了。  分析 操作和分析和systrace类似
 查看掉帧进程 常看进程中线程阻塞/耗时情况 如果是阻塞，可继续分析是否被其他进程block 了解大概耗时代码位置，接着用CPU Profiler分析具体那些地方耗时过长  CPU Profiler AS 3.0之后版本支持，替代Android Monitor tools
使用  点击 View &gt; Tool Windows &gt; Android Profiler（也可以点击底部工具栏中的Profiler）。 点击&#43;号，添加目标进程，点击cpu选项，选择record java method，进行问题复现，点击stopRecording 对相关结果分析，可通过topdown等tab，快速定位  特殊场景
启动性能分析  可通过adb shell am start -W pakageName/activityClassPath 命令，查看冷启动耗时 可以注意到AS CPU Profiler只能检测启动中的进程，这时候需要通过插桩方式，在设备中生成trace，再将tarce拉取到AS中分析  具体步骤为：
 application 中 onCreate()方法加入 Debug.startMethodTracing(“sample-name”); 在启动绘制结束地方，activity中onWindownFocusChange()中可添加Debug.stopMethodTracing(); 复现问题后，系统将在getExternalFilesDir() 目录下生成 ....</p>
  </section>
  <footer class="entry-footer"><span title='2022-03-21 22:01:14 +0800 CST'>March 21, 2022</span></footer>
  <a class="entry-link" aria-label="post link to Android常用性能分析" href="http://minwang1.github.io/post/performance-analyze/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Emoji二三事
    </h2>
  </header>
  <section class="entry-content">
    <p>Emoji二三事 进行文本处理时常常会遇到以下emoji相关的问题：
 emoji无法显示 带emoji文本的省略(Elipze)问题 自定义emoji  以下逐个讨论。
要弄清楚emoji问题，首先要了解emoji的组成 目前字符编码标准
1 Byte = 8 bite = 8b = 8位 = 8比特
1 char = 2 Byte = 2B = 2字节 = 1字符
   编码 宽度 范围 特点     1.ASCII 8 bit 0~127 定义字符少只能显示英文   2.Unicode 2 Byte 0~2^16 特殊编码方式，Unicode的实现方式称为Unicode转换格式（Unicode Transformation Format，简称为UTF）   3.Utf-8 1 Byte  Unicode 一种，分平面显示：兼容ascii平面，拉丁文平面，其他文本平面，辅助平面   3.Utf-16 2 Byte  Unicode 一种，分平面显示：兼容ascii平面，拉丁文平面，其他文本平面，辅助平面    UTF-16 编码实现方式：...</p>
  </section>
  <footer class="entry-footer"><span title='2022-03-21 22:01:14 +0800 CST'>March 21, 2022</span></footer>
  <a class="entry-link" aria-label="post link to Emoji二三事" href="http://minwang1.github.io/post/emoji/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>EventBus原理
    </h2>
  </header>
  <section class="entry-content">
    <p>#EventBus
优缺点 优点
  跨组件事件通信功能
  轻量，快速，代码优化
  使用简单缺点
  过于“低耦合”，造成代码几个混乱，难以测试和追踪。
  无法进程IPC， 配置了Android:process的service无法使用eventBus通信。 ### 使用方法1. Define events:
public static class MessageEvent { /* Additional fields if needed */ }    Prepare subscribers: Declare and annotate your subscribing method, optionally specify a thread mode:
@Subscribe(threadMode = ThreadMode.MAIN) public void onMessageEvent(MessageEvent event) {/* Do something */}; Register and unregister your subscriber. For example on Android, activities and fragments should usually register according to their life cycle:...</p>
  </section>
  <footer class="entry-footer"><span title='2022-03-21 22:01:14 +0800 CST'>March 21, 2022</span></footer>
  <a class="entry-link" aria-label="post link to EventBus原理" href="http://minwang1.github.io/post/eventbus/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>gitCheatSheet
    </h2>
  </header>
  <section class="entry-content">
    <p>git command cheat sheet  HEAD指向当前操作的地方 相对引用：~Num 是num笔提交的引用，^指向1比提交引用。^ == ~1 HEAD~1 指向HEAD之前一笔提交，HEAD~2指向HEAD之前2笔提交 HEAD^2 比较特殊，指向HEAD最近的父合并节点的第二个合并提交。 git describe &lt;ref&gt;  命令用来描述离你最近的锚点 (tag), 它输出的结果是这样的：&lt;tag&gt;_&lt;numCommits&gt;_g&lt;hash&gt;
 git tag &lt;tagName&gt; &lt;ref&gt;  在ref位置添加一个锚点
  git rebase &lt;targetBranch&gt; 将当前分支合并到目标分支上，并且切换到合并后的分支上。
  git rebase -i 交互式rebase，可以合并多比提交
  git reset &lt;ref&gt; 本地仓库代码回退到&lt;ref&gt;指定的提交地方
  git revert &lt;ref&gt; 删除到&lt;ref&gt;提交，会产生一个删除代码的提交
  ==================远程操作=========================
  &lt;remote&gt; 远程仓库名称，默认origin
  git push &lt;remote&gt; &lt;place&gt;
  git push origin master...</p>
  </section>
  <footer class="entry-footer"><span title='2022-03-21 22:01:14 +0800 CST'>March 21, 2022</span></footer>
  <a class="entry-link" aria-label="post link to gitCheatSheet" href="http://minwang1.github.io/post/gitcheatsheet/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>Java8流式编程
    </h2>
  </header>
  <section class="entry-content">
    <p>流式编程 背景 利用流，我们无需迭代集合中的元素，就可以提取和操作它们。这些管道通常被组合在一起，在流上形成一条操作管道
java7 过渡到 java8，直接向接口添加新方法会破坏所有老的接口实现类。Java 8 采用的解决方案是：在接口中添加被 default（默认）修饰的方法。
default Streamstream()https://github.com/LingCoder/OnJava8/blob/master/docs/book/14-Streams.md
相关API 流的生成  Stream.of()/Colleaction.stream()/Colleaction.iterator()创建流 Random 子方法生成随机流 BaseStream 相关子类方法生成流 正则表达式匹配后结果生成流  中间操作 流中获取对象，将对象作为一个流从后端输出。
 peek()允许你无修改地查看流中的元素。 示例peek(e -&gt; System.out.println(“Filtered value: &#34; &#43; e))* sorted() 元素排序。示例sorted(Comparator.reverseOrder())* distinct() 移除重复元素，类似Set的功能。示例list.stream().distinct(); filter(Predicate) 根据Predicate给的函数条件过滤元素。 示例filter(e -&gt; e &gt; 2);  应用到元素
  map(Function) 将函数操作应用在输入流元素中，将返回元素集合传递到输出流中，可改变返回元素的类型。 示例map(e -&gt; e &#43; 2);
  mapToInt(ToIntFunction)：操作同上，但结果是 IntStream。
  mapToLong(ToLongFunction)：操作同上，但结果是 LongStream。
  mapToDouble(ToDoubleFunction)：操作同上，但结果是 DoubleStream。
  flatMap(Function) Function功能是产生一个流,flatMap用于组合返回的流，扁平化为元素。 例子Stream....</p>
  </section>
  <footer class="entry-footer"><span title='2022-03-21 22:01:14 +0800 CST'>March 21, 2022</span></footer>
  <a class="entry-link" aria-label="post link to Java8流式编程" href="http://minwang1.github.io/post/streaming-programming/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>LifeCycle原理
    </h2>
  </header>
  <section class="entry-content">
    <p>1.what lifeCycle use for ? Lifecycles是一个持有组件生命周期状态（Activity、Fragment）信息的类，用来解决生命周期管理问题的组件。 通过监听生命周期的方式(Handling Lifecycles with Lifecycle-Aware Components)，并允许其他对象观察此状态。
在Android框架中生命周期是由系统管理的，应用必须要遵循，否则可能会导致内存泄漏等严重问题。 此外，无法保证组件会在 Activity 或 Fragment 停止之前启动。在我们需要执行长时间运行的操作（如 onStart() 中的某种配置检查）时尤其如此。这可能会导致出现一种竞争条件，在这种条件下，onStop() 方法会在 onStart() 之前结束， 这使得组件留存的时间比所需的时间要长。
所以需要Lifecycle这个组件来帮助我们管理生命周期。 Lifecycle 是一个类，用于存储有关组件（如 Activity 或 Fragment）的生命周期状态的信息，并允许其他对象观察此状态。
lifeCycle中有如下状态图，以将状态看作图中的节点，将事件看作这些节点之间的边。
2.LifeCycle 组件的使用方法  如何让一个对象有activity生命周期？   实现LifecycleOwner接口，表示类有生命周期。 注册LifecycleObserver到LifecycleOwner中。   class MyActivity extends AppCompatActivity {  private MyLocationListener myLocationListener;   public void onCreate(...) {  myLocationListener = new MyLocationListener(this, getLifecycle(), location -&gt; {  // update UI  });  Util....</p>
  </section>
  <footer class="entry-footer"><span title='2022-03-21 22:01:14 +0800 CST'>March 21, 2022</span></footer>
  <a class="entry-link" aria-label="post link to LifeCycle原理" href="http://minwang1.github.io/post/about-lifecycle/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2>设计模式-动态代理
    </h2>
  </header>
  <section class="entry-content">
    <p>使用代码 范例 public class ProxyTest {   @Test  public void startTest() {  //创建被代理对象， 实现了sayHello接口  Hello toBeProxy = () -&gt; System.out.println(&#34;say hello&#34;);   //创建handler对象  //创建代理对象  Hello hello = (Hello) Proxy.newProxyInstance(Hello.class.getClassLoader(), new Class[]{ Hello.class}, new HelloHandler(toBeProxy));   //执行代理对象的sayHello方法  hello.sayHello();  }   interface Hello {  void sayHello();  }   public class HelloHandler implements InvocationHandler {   private Object target;   public HelloHandler(Object target) {  this....</p>
  </section>
  <footer class="entry-footer"><span title='2022-03-21 22:01:14 +0800 CST'>March 21, 2022</span></footer>
  <a class="entry-link" aria-label="post link to 设计模式-动态代理" href="http://minwang1.github.io/post/dynamic-proxy/"></a>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="http://minwang1.github.io/">minwang1</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
